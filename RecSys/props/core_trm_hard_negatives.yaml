# Configuration for CORE-trm with Optimized Negative Sampling
# Implements hard negative mining and hybrid loss functions

# Model Architecture
embedding_size: 64
n_layers: 1
n_heads: 2
inner_size: 256

# Dropout Configuration
hidden_dropout_prob: 0.2
attn_dropout_prob: 0.2
sess_dropout: 0.2
item_dropout: 0.25

# Activation and Normalization
hidden_act: 'gelu'
layer_norm_eps: 1e-12
initializer_range: 0.02

# Hard Negative Sampling Parameters
use_hard_negatives: True       # Enable hard negative mining
num_hard_negatives: 128         # Number of hard negatives to sample per batch
hard_neg_weight: 0.3            # Weight for hard negative loss (if not using BPR)

# Ranking Loss Configuration
use_bpr_loss: True              # Use BPR pairwise ranking loss
bpr_weight: 0.2                 # Weight for BPR loss in hybrid objective
ranking_margin: 0.5             # Margin for ranking losses

# Temperature for RDM
temperature: 0.07

# Loss Configuration
loss_type: 'CE'
